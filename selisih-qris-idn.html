<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHORCUT SELISIH QRIS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’³</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            position: relative;
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            background: #0A192F;
        }
        
        /* Background layer terpisah untuk performa lebih baik */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0), rgba(15, 35, 70, 0), rgba(255, 255, 255, 0)),
                        url('https://cdn.areabermain.club/assets/cdn/az8/2025/11/19/20251119/9e6dcba5f4e223f30432ee6f22abe6dd/new-background-ziatogel.jpg');
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            z-index: -1;
            will-change: transform;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(10, 20, 40, 0.92);
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6),
                        0 0 30px rgba(255, 215, 0, 0.2);
            padding: 30px;
            overflow: hidden;
            border: 2px solid rgba(255, 215, 0, 0.3);
            transform: translateZ(0);
            backface-visibility: hidden;
            backdrop-filter: blur(10px);
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 3px solid #FFD700;
            position: relative;
        }
        
        h1 {
            color: #FFD700;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.6),
                         0 0 40px rgba(255, 215, 0, 0.3);
        }
        
        @keyframes neonGlow {
            from {
                text-shadow: 0 0 20px rgba(255, 215, 0, 0.8),
                             0 0 40px rgba(255, 215, 0, 0.5);
            }
            to {
                text-shadow: 0 0 30px rgba(255, 215, 0, 1),
                             0 0 60px rgba(255, 215, 0, 0.7),
                             0 0 80px rgba(255, 215, 0, 0.5);
            }
        }
        
        .columns-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .column {
            flex: 1;
            min-width: 300px;
            background: rgba(25, 50, 90, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255, 215, 0, 0.2);
            transform: translateZ(0);
        }
        
        .column:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
        }
        
        .column h2 {
            color: #FFD700;
            border-bottom: 2px solid #FFA500;
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .column-actions {
            display: flex;
            gap: 10px;
        }
        
        .column-btn {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid rgba(255, 215, 0, 0.4);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #FFD700;
        }
        
        .column-btn:hover {
            background: rgba(255, 215, 0, 0.4);
            color: #fff;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
        }
        
        textarea {
            width: 100%;
            height: 150px;
            padding: 15px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            resize: vertical;
            background-color: rgba(10, 20, 40, 0.9);
            color: #e0e0e0;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        textarea:focus {
            border-color: #FFD700;
            outline: none;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
        }
        
        textarea::placeholder {
            color: rgba(255, 215, 0, 0.5);
        }
        
        .buttons {
            text-align: center;
            margin: 20px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }
        
        .btn {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 165, 0, 0.3));
            color: #FFD700;
            border: 2px solid rgba(255, 215, 0, 0.5);
            padding: 12px 25px;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            font-weight: bold;
            min-width: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transform: translateZ(0);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 165, 0, 0.4));
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-reset {
            background: linear-gradient(135deg, rgba(100, 100, 150, 0.3), rgba(120, 120, 180, 0.4));
            border-color: rgba(150, 150, 200, 0.5);
            color: #ADD8E6;
        }
        
        .btn-reset:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        .btn-copy {
            background: linear-gradient(135deg, rgba(50, 200, 100, 0.3), rgba(70, 220, 120, 0.4));
            border-color: rgba(100, 230, 140, 0.5);
            color: #90EE90;
        }
        
        .btn-copy:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        .btn-undo {
            background: linear-gradient(135deg, rgba(150, 100, 200, 0.3), rgba(170, 120, 220, 0.4));
            border-color: rgba(180, 130, 230, 0.5);
            color: #DDA0DD;
        }
        
        .btn-undo:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        .results-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 25px;
            margin-bottom: 30px;
        }
        
        .result-card {
            background: rgba(20, 40, 80, 0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            border-top: 4px solid #FFD700;
            text-align: center;
            transition: transform 0.3s ease;
            position: relative;
            border: 1px solid rgba(255, 215, 0, 0.2);
            transform: translateZ(0);
        }
        
        .result-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
        }
        
        .result-card h3 {
            margin-top: 0;
            color: #FFD700;
            margin-bottom: 12px;
            font-size: 1.2rem;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .result-card p {
            color: #ADD8E6;
            font-size: 0.9rem;
        }
        
        .total {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .total.admin {
            color: #87CEEB;
            text-shadow: 0 0 10px rgba(135, 206, 235, 0.5);
        }
        
        .total.zona {
            color: #90EE90;
            text-shadow: 0 0 10px rgba(144, 238, 144, 0.5);
        }
        
        .total.p2mih {
            color: #DDA0DD;
            text-shadow: 0 0 10px rgba(221, 160, 221, 0.5);
        }
        
        .copy-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            color: rgba(255, 215, 0, 0.6);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .copy-icon:hover {
            color: #FFD700;
            transform: scale(1.2);
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
        }
        
        .direct-comparison {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 25px;
        }
        
        .comparison-card {
            background: rgba(25, 50, 90, 0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            text-align: center;
            flex: 1;
            min-width: 250px;
            border-top: 3px solid #FFD700;
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 215, 0, 0.2);
            transform: translateZ(0);
        }
        
        .comparison-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
        }
        
        .comparison-card h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #FFD700;
            font-size: 1.2rem;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .comparison-value {
            font-size: 20px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .positive {
            color: #90EE90;
            text-shadow: 0 0 10px rgba(144, 238, 144, 0.6);
        }
        
        .negative {
            color: #FF6B6B;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.6);
        }
        
        .comparison-desc {
            font-size: 14px;
            color: #ADD8E6;
            margin-top: 8px;
        }
        
        .comparison-section {
            background: linear-gradient(135deg, rgba(20, 40, 80, 0.95), rgba(30, 50, 90, 0.95));
            color: white;
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            margin-bottom: 20px;
            position: relative;
            border: 2px solid rgba(255, 215, 0, 0.3);
            transform: translateZ(0);
        }
        
        .comparison-section h2 {
            text-align: center;
            margin-top: 0;
            margin-bottom: 20px;
            color: #FFD700;
            font-size: 1.6rem;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }
        
        .diff-result {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .diff-result h3 {
            margin-bottom: 12px;
            font-size: 1.3rem;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .diff-value {
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .revised-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: rgba(15, 30, 60, 0.8);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .revised-table th, 
        .revised-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .revised-table th {
            background-color: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            font-weight: 600;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .revised-table .positive {
            color: #90EE90;
        }
        
        .revised-table .negative {
            color: #FF6B6B;
        }
        
        .user-id-cell {
            font-weight: bold;
            color: #87CEEB;
            text-shadow: 0 0 10px rgba(135, 206, 235, 0.5);
        }
        
        .instructions {
            background-color: rgba(20, 40, 80, 0.9);
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 215, 0, 0.2);
            transform: translateZ(0);
        }
        
        .instructions h3 {
            color: #FFD700;
            margin-top: 0;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #FFA500;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .instructions ul {
            padding-left: 20px;
            margin-bottom: 15px;
            color: #ADD8E6;
        }
        
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .highlight {
            background-color: rgba(255, 215, 0, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
            color: #FFD700;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: #FFD700;
            font-size: 0.9rem;
            padding: 20px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: rgba(25, 50, 90, 0.7);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .summary-card:hover {
            transform: translateY(-3px);
            background: rgba(25, 50, 90, 0.9);
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.3);
        }
        
        .info-box {
            background: rgba(255, 215, 0, 0.1);
            border-left: 4px solid #FFD700;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            color: #ADD8E6;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: rgba(20, 40, 80, 0.95);
            color: #FFD700;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            transform: translateX(150%);
            transition: transform 0.4s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            border-left: 4px solid #FFD700;
            border: 2px solid rgba(255, 215, 0, 0.4);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notepad-icon {
            font-size: 24px;
            color: #FFD700;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            box-shadow: 0 0 10px currentColor;
        }
        
        .status-ready {
            background: #90EE90;
        }
        
        .status-waiting {
            background: #FFA500;
        }
        
        .status-match {
            background: #87CEEB;
        }
        
        .status-error {
            background: #FF6B6B;
        }
        
        .match-indicator {
            text-align: center;
            padding: 20px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 8px;
            margin: 20px 0;
            border: 2px dashed #FFD700;
            transform: translateZ(0);
        }
        
        .match-indicator i {
            font-size: 48px;
            color: #90EE90;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 15px rgba(144, 238, 144, 0.7));
        }
        
        @keyframes successPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }
        
        .match-indicator h3 {
            color: #FFD700;
            font-size: 2rem;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }
        
        .copy-row-btn {
            background: transparent;
            border: none;
            color: rgba(255, 215, 0, 0.6);
            cursor: pointer;
            padding: 5px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .copy-row-btn:hover {
            color: #FFD700;
            transform: scale(1.2);
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
        }
        
        .spreadsheet-helper {
            background: rgba(255, 215, 0, 0.1);
            border: 1px dashed #FFD700;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
            color: #ADD8E6;
        }
        
        .spreadsheet-helper strong {
            color: #FFD700;
        }
        
        @media (max-width: 768px) {
            .columns-container {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                margin: 5px 0;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .revised-table {
                font-size: 0.8rem;
            }
            
            .direct-comparison {
                flex-direction: column;
            }
        }
        
        /* Loading animation untuk status */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification">
        <div class="notification-content">
            <i class="fas fa-clipboard notepad-icon"></i>
            <span id="notification-text">Berhasil disalin!</span>
        </div>
    </div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-qrcode"></i> SHORCUT SELISIH QRIS</h1>
            
            <div style="margin-top: 15px; font-size: 1rem; color: #ADD8E6;">
                <span class="status-indicator status-waiting" id="status-indicator"></span>
                <span id="status-text">Status: Menunggu input data</span>
            </div>
        </header>
        
        <div class="columns-container">
            <div class="column">
                <h2><i class="fas fa-user-shield"></i> ADMIN IDN
                    <div class="column-actions">
                        <button class="column-btn" title="Undo" onclick="undo('adminData')">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button class="column-btn" title="Clear" onclick="clearTextarea('adminData')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </h2>
                <textarea id="adminData" placeholder="Tempel data ADMIN IDN di sini (format: TO, BY, Coin)" oninput="updateStatus()"></textarea>
                <div class="info-box">
                    <i class="fas fa-info-circle"></i> <strong>Format:</strong> TO, BY, Coin
                </div>
            </div>
            
            <div class="column">
                <h2><i class="fas fa-globe"></i> ZONAMAIN
                    <div class="column-actions">
                        <button class="column-btn" title="Undo" onclick="undo('zonaData')">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button class="column-btn" title="Clear" onclick="clearTextarea('zonaData')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </h2>
                <textarea id="zonaData" placeholder="Tempel data ZONAMAIN di sini (format: ORDER ID, RRN, CLIENT NAME, USER ID, OPERATOR, JUMLAH)" oninput="updateStatus()"></textarea>
                <div class="info-box">
                    <i class="fas fa-info-circle"></i> <strong>Format:</strong> ORDER ID, RRN, CLIENT NAME, USER ID, OPERATOR, JUMLAH
                </div>
            </div>
            
            <div class="column">
                <h2><i class="fas fa-mobile-alt"></i> QRIS
                    <div class="column-actions">
                        <button class="column-btn" title="Undo" onclick="undo('p2mihData')">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button class="column-btn" title="Clear" onclick="clearTextarea('p2mihData')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </h2>
                <textarea id="p2mihData" placeholder="Tempel data QRIS di sini
Format P2MIH: reference_no (kolom 2), amount (kolom 3), remark/user ID (kolom 16)
Format MINERA: Order ID (kolom 4), Amount (kolom 6), User ID (kolom 12)" oninput="updateStatus()"></textarea>
                <div class="info-box">
                    <i class="fas fa-info-circle"></i> <strong>Format QRIS MINERA:</strong> reference_no (kolom 2), amount (kolom 3), remark (kolom 16)<br>
                    <strong>Format QRIS P2MIH:</strong> Order ID (kolom 4), Amount (kolom 6), User ID (kolom 12)
                </div>
            </div>
        </div>
        
        <div class="buttons">
            <button class="btn" onclick="calculate()" id="calculateBtn" disabled="">
                <i class="fas fa-calculator"></i> Hitung Data
            </button>
            <button class="btn btn-reset" onclick="resetForm()">
                <i class="fas fa-redo"></i> Reset Form
            </button>
            <button class="btn btn-undo" onclick="undoAll()">
                <i class="fas fa-history"></i> Undo All
            </button>
        </div>
        
        <div class="results-container">
            <div class="result-card">
                <h3><i class="fas fa-coins"></i> Total ADMIN IDN</h3>
                <p>Jumlah nominal dari kolom ADMIN IDN</p>
                <div id="adminTotal" class="total admin">Rp0</div>
                <i class="fas fa-copy copy-icon" onclick="copyToClipboard('adminTotal', 'Total ADMIN IDN')"></i>
            </div>
            
            <div class="result-card">
                <h3><i class="fas fa-coins"></i> Total ZONAMAIN</h3>
                <p>Jumlah nominal dari kolom ZONAMAIN</p>
                <div id="zonaTotal" class="total zona">Rp0</div>
                <i class="fas fa-copy copy-icon" onclick="copyToClipboard('zonaTotal', 'Total ZONAMAIN')"></i>
            </div>
            
            <div class="result-card">
                <h3><i class="fas fa-coins"></i> Total QRIS</h3>
                <p>Jumlah nominal dari kolom QRIS</p>
                <div id="p2mihTotal" class="total p2mih">Rp0</div>
                <i class="fas fa-copy copy-icon" onclick="copyToClipboard('p2mihTotal', 'Total QRIS')"></i>
            </div>
        </div>
        
        <!-- Perbandingan Langsung -->
        <div class="direct-comparison" id="directComparison" style="display: none;">
            <div class="comparison-card">
                <h3>QRIS - ADMIN IDN</h3>
                <div id="p2mihAdminDiff" class="comparison-value">Rp0</div>
                <div id="p2mihAdminDesc" class="comparison-desc">QRIS = ADMIN IDN</div>
            </div>
            
            <div class="comparison-card">
                <h3>QRIS - ZONAMAIN</h3>
                <div id="p2mihZonaDiff" class="comparison-value">Rp0</div>
                <div id="p2mihZonaDesc" class="comparison-desc">QRIS = ZONAMAIN</div>
            </div>
            
            <div class="comparison-card">
                <h3>ZONAMAIN - ADMIN IDN</h3>
                <div id="zonaAdminDiff" class="comparison-value">Rp0</div>
                <div id="zonaAdminDesc" class="comparison-desc">ZONAMAIN = ADMIN IDN</div>
            </div>
        </div>
        
        <div class="buttons">
            <button class="btn btn-copy" onclick="copyAllTotals()">
                <i class="fas fa-copy"></i> Copy All Total
            </button>
            <button class="btn" onclick="copyAllDifferences()">
                <i class="fas fa-copy"></i> Copy All Selisih
            </button>
        </div>
        
        <div class="comparison-section">
            <h2><i class="fas fa-chart-bar"></i> Perbandingan Data</h2>
            
            <div id="matchContainer" class="match-indicator" style="display: none;">
                <i class="fas fa-check-circle"></i>
                <h3>KLOP YA KO!</h3>
                <p>Total ADMIN IDN, ZONAMAIN, dan QRIS memiliki nominal yang sama</p>
            </div>
            
            <div id="comparisonContainer">
                <div id="summaryGrid" class="summary-grid">
                    <div class="summary-card">
                        <h3>ADMIN IDN vs ZONAMAIN</h3>
                        <div id="adminZonaDiff" class="diff-value">Rp0</div>
                        <p>Status: <span id="adminZonaDesc">ADMIN IDN = ZONAMAIN</span></p>
                    </div>
                    
                    <div class="summary-card">
                        <h3>ZONAMAIN vs QRIS</h3>
                        <div id="zonaP2mihDiff" class="diff-value">Rp0</div>
                        <p>Status: <span id="zonaP2mihDesc">ZONAMAIN = QRIS</span></p>
                    </div>
                    
                    <div class="summary-card">
                        <h3>ADMIN IDN vs QRIS</h3>
                        <div id="adminP2mihDiff" class="diff-value">Rp0</div>
                        <p>Status: <span id="adminP2mihDesc">ADMIN IDN = QRIS</span></p>
                    </div>
                </div>
                
                <div id="orderDiffContainer">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="color: #FFD700; margin: 0; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);"><i class="fas fa-list-ul"></i> HASIL</h3>
                        <button class="btn btn-copy" onclick="copyAllRows()" style="padding: 8px 15px; font-size: 14px;">
                            <i class="fas fa-copy"></i> Copy Semua
                        </button>
                    </div>
                    <table class="revised-table" id="revisedDiffTable">
                        <thead>
                            <tr>
                                <th><i class="fas fa-user"></i> User ID</th>
                                <th><i class="fas fa-receipt"></i> Order ID</th>
                                <th><i class="fas fa-money-bill-wave"></i> Selisih</th>
                                <th><i class="fas fa-info-circle"></i> Keterangan</th>
                                <th><i class="fas fa-tools"></i> Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="5" style="text-align: center;">Tidak ada dana belum terproses</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="spreadsheet-helper">
                        <i class="fas fa-info-circle"></i> 
                        <strong>Tips docsheet:</strong> Ketika menyalin data, tempel langsung di docsheet 
                        dan data akan otomatis terpisah ke kolom yang sesuai
                    </div>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-book"></i> Petunjuk Penggunaan:</h3>
            <ul>
                <li><i class="fas fa-angle-right"></i> Tempel data untuk <span class="highlight">ADMIN IDN</span> di kolom pertama</li>
                <li><i class="fas fa-angle-right"></i> Tempel data untuk <span class="highlight">ZONAMAIN</span> di kolom kedua</li>
                <li><i class="fas fa-angle-right"></i> Tempel data untuk <span class="highlight">QRIS</span> di kolom ketiga (mendukung format QRIS P2MIH dan QRIS MINERA)</li>
                <li><i class="fas fa-angle-right"></i> Klik tombol <span class="highlight">Hitung Data</span> untuk memproses informasi</li>
                <li><i class="fas fa-angle-right"></i> Gunakan tombol <i class="fas fa-undo"></i> untuk mengembalikan data sebelumnya</li>
                <li><i class="fas fa-angle-right"></i> Klik ikon <i class="fas fa-copy"></i> untuk menyalin data yang siap ditempel di docsheet</li>
                <li><i class="fas fa-angle-right"></i> Perhatikan <span class="highlight">Perbandingan Langsung</span> untuk melihat selisih jumlah</li>
            </ul>
        </div>
    </div>
    
    <footer>
        <i class="fas fa-shield-alt"></i> Â© 2025 SHORCUT SELISIH <i class="fas fa-shield-alt"></i>
    </footer>
    
    <script>
        // State untuk menyimpan history undo
        const undoHistory = {
            adminData: [],
            zonaData: [],
            p2mihData: []
        };
        
        // Simpan nilai total untuk copy
        let currentTotals = {
            admin: 0,
            zona: 0,
            p2mih: 0
        };
        
        // Simpan data selisih
        let unprocessedFunds = [];
        
        // Status bar
        function updateStatus() {
            const admin = document.getElementById('adminData').value.trim();
            const zona = document.getElementById('zonaData').value.trim();
            const p2mih = document.getElementById('p2mihData').value.trim();
            const indicator = document.getElementById('status-indicator');
            const statusText = document.getElementById('status-text');
            
            if (admin && zona && p2mih) {
                indicator.className = 'status-indicator status-ready';
                statusText.textContent = 'Status: Data lengkap, siap dihitung';
                document.getElementById('calculateBtn').disabled = false;
            } else if (admin || zona || p2mih) {
                indicator.className = 'status-indicator status-waiting';
                statusText.textContent = 'Status: Data parsial, bisa dihitung';
                document.getElementById('calculateBtn').disabled = false;
            } else {
                indicator.className = 'status-indicator status-waiting';
                statusText.textContent = 'Status: Menunggu input data';
                document.getElementById('calculateBtn').disabled = true;
            }
        }
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }
        
        // Fungsi untuk menyimpan state sebelum diubah
        function saveState(textareaId) {
            const textarea = document.getElementById(textareaId);
            undoHistory[textareaId].push(textarea.value);
            
            // Batasi history hanya 5 langkah terakhir
            if (undoHistory[textareaId].length > 5) {
                undoHistory[textareaId].shift();
            }
        }
        
        // Fungsi undo per textarea
        function undo(textareaId) {
            if (undoHistory[textareaId].length > 0) {
                const lastValue = undoHistory[textareaId].pop();
                document.getElementById(textareaId).value = lastValue;
                updateStatus();
                showNotification(`Data ${textareaId} dikembalikan`);
            } else {
                showNotification("Tidak ada data sebelumnya");
            }
        }
        
        // Fungsi undo all
        function undoAll() {
            undo('adminData');
            undo('zonaData');
            undo('p2mihData');
        }
        
        // Fungsi clear textarea
        function clearTextarea(textareaId) {
            saveState(textareaId);
            document.getElementById(textareaId).value = '';
            updateStatus();
            showNotification(`Data ${textareaId} dihapus`);
        }
        
        // Format mata uang untuk tampilan
        function formatCurrency(value) {
            return 'Rp' + value.toLocaleString('id-ID');
        }
        
        // Format untuk copy (tanpa titik, tanpa Rp)
        function formatForCopy(value) {
            return value.toLocaleString('id-ID', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).replace(/\./g, '');
        }
        
        // Bersihkan format mata uang
        function cleanCurrency(value) {
            if (typeof value === 'string') {
                value = value.replace(/\./g, '').replace(',', '.');
            }
            return parseFloat(value) || 0;
        }
        
        // Parse data ADMIN
        function parseAdminData(data) {
            const lines = data.trim().split('\n');
            const users = {};
            let total = 0;
            
            // Jika tidak ada data, return total 0
            if (lines.length === 0 || (lines.length === 1 && lines[0].trim() === '')) {
                return { total: 0, users: {} };
            }
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                if (i === 0 && (line.includes('TO') || line.includes('BY') || line.includes('Coin'))) {
                    continue;
                }
                
                const parts = line.split('\t');
                if (parts.length < 3) continue;
                
                const user = parts[0];
                let amountStr = parts[2].replace(/,/g, '');
                const amount = parseFloat(amountStr) || 0;
                
                users[user] = (users[user] || 0) + amount;
                total += amount;
            }
            
            return { total, users };
        }
        
        // Parse data ZONA
        function parseZonaData(data) {
            const lines = data.trim().split('\n');
            const orders = {};
            const users = {};
            let total = 0;
            
            // Jika tidak ada data, return total 0
            if (lines.length === 0 || (lines.length === 1 && lines[0].trim() === '')) {
                return { total: 0, orders: {}, users: {} };
            }
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                if (i === 0 && (line.includes('ORDER') || line.includes('RRN') || line.includes('JUMLAH'))) {
                    continue;
                }
                
                const parts = line.split('\t');
                if (parts.length < 6) continue;
                
                const orderId = parts[0];
                const userId = parts[3];
                const amount = cleanCurrency(parts[5]);
                
                orders[orderId] = { userId, amount };
                users[userId] = (users[userId] || 0) + amount;
                total += amount;
            }
            
            return { total, orders, users };
        }
        
        // Fungsi untuk mendeteksi format P2MIH
        function detectP2mihFormat(data) {
            const lines = data.trim().split('\n');
            if (lines.length === 0) return 'unknown';
            
            // Cek baris pertama atau kedua untuk mendeteksi format
            for (let i = 0; i < Math.min(2, lines.length); i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const parts = line.split('\t');
                
                // Format baru: minimal 16 kolom, kolom 2 adalah reference_no (UUID format)
                if (parts.length >= 16) {
                    // Cek apakah kolom 2 (index 1) seperti UUID
                    const col2 = parts[1];
                    if (col2.includes('-') && col2.length >= 30) {
                        return 'new'; // Format QRIS P2MIH
                    }
                }
                
                // Format lama: minimal 12 kolom
                if (parts.length >= 12 && parts.length < 16) {
                    return 'old'; // Format QRIS MINERA
                }
            }
            
            return 'unknown';
        }
        
        // Parse data P2MIH - UPDATED untuk mendukung 2 format
        function parseP2mihData(data) {
            const lines = data.trim().split('\n');
            const orders = {};
            const users = {};
            let total = 0;
            
            // Jika tidak ada data, return total 0
            if (lines.length === 0 || (lines.length === 1 && lines[0].trim() === '')) {
                return { total: 0, orders: {}, users: {} };
            }
            
            // Deteksi format
            const format = detectP2mihFormat(data);
            console.log('Detected P2MIH format:', format);
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                // Skip header jika ada
                if (i === 0 && (line.includes('Date') || line.includes('Amount') || line.includes('id') || line.includes('reference_no'))) {
                    continue;
                }
                
                const parts = line.split('\t');
                
                if (format === 'new') {
                    // Format QRIS P2MIH: reference_no (kolom 2), amount (kolom 3), remark (kolom 16)
                    if (parts.length < 16) continue;
                    
                    const orderId = parts[1]; // reference_no di kolom 2 (index 1)
                    const amount = cleanCurrency(parts[2]); // amount di kolom 3 (index 2)
                    
                    // Ekstrak user ID dari remark di kolom 16 (index 15)
                    // Format: "jpbosku02||7xMw8wc9WmOj4dKaqFgp||234"
                    // Hanya ambil bagian sebelum "||"
                    let userId = parts[15];
                    if (userId && userId.includes('||')) {
                        userId = userId.split('||')[0];
                    }
                    
                    orders[orderId] = { userId, amount };
                    users[userId] = (users[userId] || 0) + amount;
                    total += amount;
                    
                } else if (format === 'old') {
                    // Format QRIS MINERA: Order ID (kolom 4), Amount (kolom 6), User ID (kolom 12)
                    if (parts.length < 12) continue;
                    
                    const orderId = parts[3]; // Order ID di kolom 4 (index 3)
                    const amount = cleanCurrency(parts[5]); // Amount di kolom 6 (index 5)
                    
                    // Ekstrak user ID dari kolom 12 (index 11)
                    let userId = parts[11];
                    if (userId && userId.includes('||')) {
                        userId = userId.split('||')[0];
                    }
                    
                    orders[orderId] = { userId, amount };
                    users[userId] = (users[userId] || 0) + amount;
                    total += amount;
                }
            }
            
            return { total, orders, users };
        }
        
        // Hitung data
        function calculate() {
            // Simpan state sebelum menghitung
            saveState('adminData');
            saveState('zonaData');
            saveState('p2mihData');
            
            // Get data dari textarea
            const adminData = document.getElementById('adminData').value;
            const zonaData = document.getElementById('zonaData').value;
            const p2mihData = document.getElementById('p2mihData').value;
            
            // Parse data
            const adminResult = parseAdminData(adminData);
            const zonaResult = parseZonaData(zonaData);
            const p2mihResult = parseP2mihData(p2mihData);
            
            // Simpan nilai untuk copy
            currentTotals.admin = adminResult.total;
            currentTotals.zona = zonaResult.total;
            currentTotals.p2mih = p2mihResult.total;
            
            // Tampilkan hasil total
            document.getElementById('adminTotal').textContent = formatCurrency(adminResult.total);
            document.getElementById('zonaTotal').textContent = formatCurrency(zonaResult.total);
            document.getElementById('p2mihTotal').textContent = formatCurrency(p2mihResult.total);
            
            // Tampilkan hasil selisih langsung
            const directComparison = document.getElementById('directComparison');
            directComparison.style.display = 'flex';
            
            // Hitung selisih langsung
            const p2mihAdminDiff = p2mihResult.total - adminResult.total;
            const p2mihZonaDiff = p2mihResult.total - zonaResult.total;
            const zonaAdminDiff = zonaResult.total - adminResult.total;
            
            // Tampilkan hasil selisih langsung
            const p2mihAdminElement = document.getElementById('p2mihAdminDiff');
            p2mihAdminElement.textContent = formatCurrency(Math.abs(p2mihAdminDiff));
            p2mihAdminElement.className = 'comparison-value ' + (p2mihAdminDiff >= 0 ? 'positive' : 'negative');
            document.getElementById('p2mihAdminDesc').textContent = 
                p2mihAdminDiff > 0 ? `QRIS lebih besar (${formatCurrency(p2mihAdminDiff)})` : 
                p2mihAdminDiff < 0 ? `ADMIN IDN lebih besar (${formatCurrency(-p2mihAdminDiff)})` : 
                'Sama besar';
            
            const p2mihZonaElement = document.getElementById('p2mihZonaDiff');
            p2mihZonaElement.textContent = formatCurrency(Math.abs(p2mihZonaDiff));
            p2mihZonaElement.className = 'comparison-value ' + (p2mihZonaDiff >= 0 ? 'positive' : 'negative');
            document.getElementById('p2mihZonaDesc').textContent = 
                p2mihZonaDiff > 0 ? `QRIS lebih besar (${formatCurrency(p2mihZonaDiff)})` : 
                p2mihZonaDiff < 0 ? `ZONAMAIN lebih besar (${formatCurrency(-p2mihZonaDiff)})` : 
                'Sama besar';
            
            const zonaAdminElement = document.getElementById('zonaAdminDiff');
            zonaAdminElement.textContent = formatCurrency(Math.abs(zonaAdminDiff));
            zonaAdminElement.className = 'comparison-value ' + (zonaAdminDiff >= 0 ? 'positive' : 'negative');
            document.getElementById('zonaAdminDesc').textContent = 
                zonaAdminDiff > 0 ? `ZONAMAIN lebih besar (${formatCurrency(zonaAdminDiff)})` : 
                zonaAdminDiff < 0 ? `ADMIN IDN lebih besar (${formatCurrency(-zonaAdminDiff)})` : 
                'Sama besar';
            
            // Hitung selisih
            const adminZonaDiff = adminResult.total - zonaResult.total;
            const zonaP2mihDiff = p2mihResult.total - zonaResult.total;
            const adminP2mihDiff = adminResult.total - p2mihResult.total;
            
            // Periksa apakah semua nominal sama
            const allMatch = adminResult.total === zonaResult.total && 
                             zonaResult.total === p2mihResult.total;
            
            // Tampilkan/sembunyikan konten berdasarkan kesamaan nominal
            const matchContainer = document.getElementById('matchContainer');
            const comparisonContainer = document.getElementById('comparisonContainer');
            
            if (allMatch) {
                matchContainer.style.display = 'block';
                comparisonContainer.style.display = 'none';
                
                // Update status indicator
                document.getElementById('status-indicator').className = 'status-indicator status-match';
                document.getElementById('status-text').textContent = 'Status: Semua data cocok!';
            } else {
                matchContainer.style.display = 'none';
                comparisonContainer.style.display = 'block';
                
                // Update status indicator
                document.getElementById('status-indicator').className = 'status-indicator status-ready';
                document.getElementById('status-text').textContent = 'Status: Perhitungan selesai';
            }
            
            // Tampilkan selisih dengan deskripsi
            const adminZonaElement = document.getElementById('adminZonaDiff');
            adminZonaElement.textContent = formatCurrency(Math.abs(adminZonaDiff));
            adminZonaElement.className = 'diff-value ' + (adminZonaDiff >= 0 ? 'negative' : 'positive');
            document.getElementById('adminZonaDesc').textContent = 
                adminZonaDiff > 0 ? `ADMIN IDN lebih besar (${formatCurrency(adminZonaDiff)})` : 
                adminZonaDiff < 0 ? `ZONAMAIN lebih besar (${formatCurrency(-adminZonaDiff)})` : 
                'Sama besar';
            
            const zonaP2mihElement = document.getElementById('zonaP2mihDiff');
            zonaP2mihElement.textContent = formatCurrency(Math.abs(zonaP2mihDiff));
            zonaP2mihElement.className = 'diff-value ' + (zonaP2mihDiff >= 0 ? 'positive' : 'negative');
            document.getElementById('zonaP2mihDesc').textContent = 
                zonaP2mihDiff > 0 ? `QRIS lebih besar (${formatCurrency(zonaP2mihDiff)})` : 
                zonaP2mihDiff < 0 ? `ZONAMAIN lebih besar (${formatCurrency(-zonaP2mihDiff)})` : 
                'Sama besar';
            
            const adminP2mihElement = document.getElementById('adminP2mihDiff');
            adminP2mihElement.textContent = formatCurrency(Math.abs(adminP2mihDiff));
            adminP2mihElement.className = 'diff-value ' + (adminP2mihDiff >= 0 ? 'negative' : 'positive');
            document.getElementById('adminP2mihDesc').textContent = 
                adminP2mihDiff > 0 ? `ADMIN IDN lebih besar (${formatCurrency(adminP2mihDiff)})` : 
                adminP2mihDiff < 0 ? `QRIS lebih besar (${formatCurrency(-adminP2mihDiff)})` : 
                'Sama besar';
            
            // Temukan dana yang belum terproses
            const revisedDiffTable = document.getElementById('revisedDiffTable').querySelector('tbody');
            revisedDiffTable.innerHTML = '';
            
            unprocessedFunds = [];
            
            // Cek dana di QRIS yang belum ada di ZONAMAIN
            for (const [orderId, p2mihData] of Object.entries(p2mihResult.orders)) {
                if (!zonaResult.orders[orderId]) {
                    unprocessedFunds.push({
                        orderId,
                        userId: p2mihData.userId,
                        diff: p2mihData.amount,
                        description: 'Dana tercetak di QRIS, tidak tercetak di ZONAMAIN dan belum terproses di ADMIN IDN'
                    });
                }
            }
            
            // Cek dana di ADMIN IDN yang belum ada di ZONAMAIN
            for (const [userId, adminAmount] of Object.entries(adminResult.users)) {
                const zonaAmount = zonaResult.users[userId] || 0;
                const diff = adminAmount - zonaAmount;
                
                if (diff > 0) {
                    unprocessedFunds.push({
                        orderId: 'N/A',
                        userId,
                        diff: -diff,
                        description: 'Dana terproses di ADMIN IDN, tidak tercetak di ZONAMAIN dan QRIS'
                    });
                }
            }
            
            // PERBAIKAN: Filter untuk hanya menampilkan satu user ID dari ADMIN IDN jika hanya ada satu
            let fundsToDisplay = [...unprocessedFunds];
            
            // Cari selisih yang berasal dari ADMIN IDN (dengan deskripsi tertentu) dan memiliki user ID
            const adminIdnDifferences = unprocessedFunds.filter(fund => 
                fund.description.includes('ADMIN IDN') && fund.userId && fund.userId !== 'N/A'
            );
            
            // Jika hanya ada satu selisih dari ADMIN IDN, maka hanya tampilkan itu
            if (adminIdnDifferences.length === 1) {
                fundsToDisplay = adminIdnDifferences;
                document.getElementById('summaryGrid').style.display = 'none';
                document.getElementById('orderDiffContainer').style.marginTop = '20px';
            } else {
                document.getElementById('summaryGrid').style.display = 'grid';
                document.getElementById('orderDiffContainer').style.marginTop = '0';
            }
            
            // Tampilkan hasil dengan format baru
            if (fundsToDisplay.length > 0) {
                for (const fund of fundsToDisplay) {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td class="user-id-cell">${fund.userId}</td>
                        <td>${fund.orderId}</td>
                        <td class="${fund.diff > 0 ? 'positive' : 'negative'}" style="font-weight: bold">
                            ${fund.diff > 0 ? '+' : ''}${formatCurrency(fund.diff)}
                        </td>
                        <td>${fund.description}</td>
                        <td>
                            <button class="copy-row-btn" onclick="copyRowData('${fund.userId}', '${fund.orderId}', ${fund.diff})" title="Salin data untuk docsheet">
                                <i class="fas fa-copy"></i>
                            </button>
                        </td>
                    `;
                    revisedDiffTable.appendChild(row);
                }
            } else {
                revisedDiffTable.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center;">Semua dana telah terproses</td>
                    </tr>
                `;
            }
            
            showNotification("Perhitungan selesai!");
        }
        
        // Salin data baris dalam format spreadsheet
        function copyRowData(userId, orderId, diff) {
            // Format untuk spreadsheet: kolom terpisah tanpa pemisah tambahan
            const textToCopy = `${userId}\t${orderId}\t${diff}`;
            
            navigator.clipboard.writeText(textToCopy)
                .then(() => {
                    showNotification("Data siap ditempel di spreadsheet!");
                })
                .catch(err => {
                    showNotification("Gagal menyalin data baris");
                });
        }
        
        // Salin semua baris selisih
        function copyAllRows() {
            if (unprocessedFunds.length === 0) {
                showNotification("Tidak ada data selisih untuk disalin");
                return;
            }
            
            // Header untuk spreadsheet
            let textToCopy = "User ID\tOrder ID\tSelisih\n";
            
            // Tambahkan setiap baris data
            for (const fund of unprocessedFunds) {
                textToCopy += `${fund.userId}\t${fund.orderId}\t${fund.diff}\n`;
            }
            
            navigator.clipboard.writeText(textToCopy)
                .then(() => {
                    showNotification("Semua data selisih siap ditempel di spreadsheet!");
                })
                .catch(err => {
                    showNotification("Gagal menyalin data");
                });
        }
        
        // Salin semua hasil selisih
        function copyAllDifferences() {
            const admin = document.getElementById('adminTotal').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const zona = document.getElementById('zonaTotal').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const p2mih = document.getElementById('p2mihTotal').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const adminZonaDiff = document.getElementById('adminZonaDiff').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const zonaP2mihDiff = document.getElementById('zonaP2mihDiff').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const adminP2mihDiff = document.getElementById('adminP2mihDiff').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const text = `Total ADMIN IDN\t${admin}\n` +
                         `Total ZONAMAIN\t${zona}\n` +
                         `Total QRIS\t${p2mih}\n\n` +
                         `ADMIN IDN vs ZONAMAIN\t${adminZonaDiff}\n` +
                         `ZONAMAIN vs QRIS\t${zonaP2mihDiff}\n` +
                         `ADMIN IDN vs QRIS\t${adminP2mihDiff}`;
            
            navigator.clipboard.writeText(text)
                .then(() => {
                    showNotification("Semua hasil selisih siap ditempel di docsheet!");
                })
                .catch(err => {
                    showNotification("Gagal menyalin data");
                });
        }
        
        // Reset form
        function resetForm() {
            // Simpan state sebelum direset
            saveState('adminData');
            saveState('zonaData');
            saveState('p2mihData');
            
            document.getElementById('adminData').value = '';
            document.getElementById('zonaData').value = '';
            document.getElementById('p2mihData').value = '';
            
            document.getElementById('adminTotal').textContent = 'Rp0';
            document.getElementById('zonaTotal').textContent = 'Rp0';
            document.getElementById('p2mihTotal').textContent = 'Rp0';
            
            // Sembunyikan hasil perbandingan langsung
            document.getElementById('directComparison').style.display = 'none';
            
            // Reset nilai perbandingan langsung
            document.getElementById('p2mihAdminDiff').textContent = 'Rp0';
            document.getElementById('p2mihAdminDesc').textContent = 'QRIS = ADMIN IDN';
            
            document.getElementById('p2mihZonaDiff').textContent = 'Rp0';
            document.getElementById('p2mihZonaDesc').textContent = 'QRIS = ZONAMAIN';
            
            document.getElementById('zonaAdminDiff').textContent = 'Rp0';
            document.getElementById('zonaAdminDesc').textContent = 'ZONAMAIN = ADMIN IDN';
            
            document.getElementById('adminZonaDiff').textContent = 'Rp0';
            document.getElementById('adminZonaDiff').className = 'diff-value';
            document.getElementById('adminZonaDesc').textContent = 'ADMIN IDN = ZONAMAIN';
            
            document.getElementById('zonaP2mihDiff').textContent = 'Rp0';
            document.getElementById('zonaP2mihDiff').className = 'diff-value';
            document.getElementById('zonaP2mihDesc').textContent = 'ZONAMAIN = QRIS';
            
            document.getElementById('adminP2mihDiff').textContent = 'Rp0';
            document.getElementById('adminP2mihDiff').className = 'diff-value';
            document.getElementById('adminP2mihDesc').textContent = 'ADMIN IDN = QRIS';
            
            document.getElementById('revisedDiffTable').querySelector('tbody').innerHTML = `
                <tr>
                    <td colspan="5" style="text-align: center;">Tidak ada dana belum terproses</td>
                </tr>
            `;
            
            // Reset data selisih
            unprocessedFunds = [];
            
            // Sembunyikan konten perbandingan jika ada
            document.getElementById('matchContainer').style.display = 'none';
            document.getElementById('comparisonContainer').style.display = 'block';
            document.getElementById('summaryGrid').style.display = 'grid';
            document.getElementById('orderDiffContainer').style.marginTop = '0';
            
            updateStatus();
            showNotification("Form telah direset");
        }
        
        // Copy ke clipboard
        function copyToClipboard(elementId, label) {
            const text = document.getElementById(elementId).textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            navigator.clipboard.writeText(text)
                .then(() => {
                    showNotification(`${label} disalin: ${text}`);
                })
                .catch(err => {
                    showNotification("Gagal menyalin teks");
                });
        }
        
        // Copy semua total
        function copyAllTotals() {
            const admin = document.getElementById('adminTotal').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const zona = document.getElementById('zonaTotal').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const p2mih = document.getElementById('p2mihTotal').textContent
                .replace('Rp', '')
                .replace(/\./g, '');
            
            const text = `Total ADMIN IDN\t${admin}\nTotal ZONAMAIN\t${zona}\nTotal QRIS\t${p2mih}`;
            
            navigator.clipboard.writeText(text)
                .then(() => {
                    showNotification("Semua total siap ditempel di docsheet!");
                })
                .catch(err => {
                    showNotification("Gagal menyalin teks");
                });
        }
        
        // Inisialisasi
        document.addEventListener('DOMContentLoaded', function() {
            // Inisialisasi status
            updateStatus();
            
            // Event listeners untuk menyimpan history
            document.getElementById('adminData').addEventListener('input', function() {
                saveState('adminData');
                updateStatus();
            });
            
            document.getElementById('zonaData').addEventListener('input', function() {
                saveState('zonaData');
                updateStatus();
            });
            
            document.getElementById('p2mihData').addEventListener('input', function() {
                saveState('p2mihData');
                updateStatus();
            });
        });
    </script>

</body>
</html>
